- alias: Update notifications
  id: notify_homeassistant_update
  trigger:
  - entity_id: updater.updater
    platform: state
  action:
  - service: notify.pushbullet
    data:
      title: New Home Assistant Release
      message: Home Assistant  {{ states.updater.updater.state }}  is now available.
      target:
      - email/mcinnes01@gmail.com
      - device/AndyPhone
- alias: Doorbell Notifications
  id: doorbell_trigger
  trigger:
    platform: state
    entity_id: binary_sensor.doorbell_button
    to: 'on'
  action:
  - service: notify.pushbullet
    data:
      title: Doorbell
      message: Ding dong! Someone is at the door!
      data:
        file_url: http://tiptag.com.ar/wp-content/uploads/2018/06/timbre1.jpg
      target:
      - email/mcinnes01@gmail.com
      - device/AndyPhone
  - service: notify.alexa_media
    data:
      title: Doorbell
      message: Ding dong! Someone is at the door!
      target:
      - media_player.everywhere
      data:
        type: announce
- id: alarm_trigger
  alias: Trigger alarm while armed away
  trigger:
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.snug_motion
    platform: device
    type: motion
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.dining_room_motion
    platform: device
    type: motion
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.utility_motion
    platform: device
    type: motion
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.cellar_door
    platform: device
    type: opened
  condition:
  - condition: state
    entity_id: alarm_control_panel.alarm
    state: armed_away
  action:
  - data: {}
    entity_id: alarm_control_panel.alarm
    service: alarm_control_panel.alarm_trigger
- alias: Send notification when alarm triggered
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: triggered
  action:
  - data:
      title: Alarm Triggered
      message: ALARM! The alarm has been triggered
      data:
        file_url: https://media.istockphoto.com/vectors/vector-fire-alarm-vector-id610426096?k=6&m=610426096&s=612x612&w=0&h=IIjBibeAUNdoq7XS4-esMGyxxw_xFkb07zbwKcwNB-I=
      target:
      - email/mcinnes01@gmail.com
      - device/AndyPhone
    service: notify.pushbullet
  - data:
      title: Alarm Triggered
      message: The alarm has been triggered. The alarm has been triggered. The alarm
        has been triggered. The alarm has been triggered. The alarm has been triggered.
      target:
      - media_player.everywhere
      data:
        type: announce
    service: notify.alexa_media
  id: 33a13ad590164e5a9542f8223820a928
- alias: Turn On Ex Machina lights when alarm triggered
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: triggered
  action:
  - data: {}
    entity_id: light.inside
    service: light.turn_off
  - data:
      brightness_pct: 100
      effect: Alarm
    entity_id: light.yeelights
    service: light.turn_on
  id: 71bcd308a0bc484793b7d78e8ec8e69d
- alias: Send notification when alarm is Disarmed
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: disarmed
  action:
  - data:
      type: announce
    service: notify.alexa_media
    data_template:
      title: Alarm disarmed
      message: ALARM! The alarm is Disarmed at {{ states('sensor.date_time') }}
      target:
      - media_player.everywhere
  id: 63385e6035f643aab8b67f619af4951b
- alias: Turn Off Ex Machina lights when alarm disarmed
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: disarmed
  action:
  - data:
      effect: Stop
    entity_id: light.yeelights
    service: light.turn_on
  - data: {}
    entity_id: light.yeelights
    service: light.turn_off
  id: 71bcd308a0bc484793b7d78e8ec8e69f
- alias: Send notification when alarm is arming
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    from: disarmed
    to: pending
  action:
  - service: notify.alexa_media
    data_template:
      title: Alarm arming
      message: The alarm is arming you have 60 seconds to leave
      target:
      - media_player.everywhere
      data:
        type: announce
  id: a71c90774150444f9237ba14769e935a
- alias: Send notification when alarm is pending
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    from: armed
    to: pending
  action:
  - service: notify.alexa_media
    data_template:
      title: Alarm pending
      message: You have 30 seconds to disable the alarm
      target:
      - media_player.everywhere
      data:
        type: announce
  id: df6ae52914e648ec8d170fc4e508c29e
- alias: Send notification when alarm is Armed in Away mode
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_away
  action:
  - service: notify.alexa_media
    data_template:
      title: Alarm armed in away mode
      message: The alarm is armed in Away mode
      target:
      - media_player.everywhere
      data:
        type: announce
  id: e430701364844f3da246e6f2db218214
- alias: Send notification when alarm is Armed in Home mode
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_home
  action:
  - service: notify.alexa_media
    data_template:
      title: Alarm armed in home mode
      message: The alarm is armed in Home mode
      target:
      - media_player.everywhere
      data:
        type: announce
  id: b762a0f5608845a2800b4b408924d844
- alias: Patio Motion
  id: '1560465284215'
  trigger:
  - platform: webhook
    webhook_id: ''
  condition: []
  action: []
- alias: Evening feed
  id: '1566893522713'
  trigger:
  - at: '17:00'
    platform: time
  condition: []
  action:
  - service: script.feed_cats
- alias: Morning Feed
  id: '1566993898921'
  trigger:
  - at: 07:00
    platform: time
  condition: []
  action:
  - service: script.feed_cats
- id: '1579518320766'
  alias: Turn On Porch Light when Sun is set
  description: ''
  trigger:
  - event: sunset
    platform: sun
  condition: []
  action:
  - entity_id: light.sonoff_100032907e_3
    service: light.turn_on
- id: '1579518409890'
  alias: Turn Off Porch Light at 11pm
  description: ''
  trigger:
  - at: '22:30:00'
    platform: time
  condition: []
  action:
  - entity_id: light.sonoff_100032907e_3
    service: light.turn_off
- id: '1579590597721'
  alias: Turn Off Back Door Light when no motion
  trigger:
  - event_data:
      entity_id: timer.patio
    event_type: timer.finished
    platform: event
  action:
  - data:
      entity_id: light.sonoff_100032907e_1
    service: light.turn_off
- id: '1579590785318'
  alias: Turn on back door light when there is movement and the sun is set
  description: ''
  trigger:
  - entity_id: binary_sensor.patio_motion
    platform: state
    to: 'on'
  condition:
  - condition: or
    conditions:
    - after: sunset
      condition: sun
    - before: sunrise
      condition: sun
  action:
  - data:
      entity_id: light.sonoff_100032907e_1
    service: light.turn_on
  - data:
      entity_id: timer.patio
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.patio
    service: timer.start
- id: '1585168264303'
  alias: Welcome Claire Home
  description: ''
  trigger: []
  condition:
  - condition: device
    device_id: 8a4eec7076b74868b1bd7f134f8b4fa2
    domain: device_tracker
    entity_id: device_tracker.claires_iphone
    type: is_home
  action:
  - service: notify.alexa_media
    data_template:
      title: Welcome home Claire
      message: Welcome home Claire
      target:
      - media_player.everywhere
      data:
        type: announce
- id: '1585417563602'
  alias: Turn On Snug Light when motion detected
  description: ''
  trigger:
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.snug_motion
    for:
      hours: 0
      minutes: 0
      seconds: 0
    platform: device
    type: motion
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032a00d_2
    service: light.turn_on
  - data:
      entity_id: timer.snug
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.snug
    service: timer.start
- id: '1585417563603'
  alias: Turn On Lounge Lamp when motion detected
  description: ''
  trigger:
  - device_id: 0310800ab747484283cf6fb58715fb0d
    domain: binary_sensor
    entity_id: binary_sensor.lounge_motion
    platform: device
    type: motion
  condition:
  - condition: or
    conditions:
    - before: sunrise
      condition: sun
    - after: sunset
      condition: sun
  action:
  - data: {}
    entity_id: light.yeelight_color1_7c49eb139475
    service: light.turn_on
  - data:
      entity_id: timer.lounge
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.lounge
    service: timer.start
- id: '1585417563607'
  alias: Turn On Basement Hall Light when motion detected
  description: ''
  trigger:
  - device_id: 0310800ab747484283cf6fb58715fb0d
    domain: binary_sensor
    entity_id: binary_sensor.basement_stairs_motion
    platform: device
    type: motion
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_3
    service: light.turn_on
  - data:
      entity_id: timer.basement_hall
    service: timer.cancel
  - data:
      duration: 00:01:00
      entity_id: timer.basement_hall
    service: timer.start
- id: '1585417563604'
  alias: Turn On Drawing Room Lamp when motion detected
  description: ''
  trigger:
  - device_id: 0310800ab747484283cf6fb58715fb0d
    domain: binary_sensor
    entity_id: binary_sensor.drawing_room_motion
    platform: device
    type: motion
  condition:
  - condition: or
    conditions:
    - before: sunrise
      condition: sun
    - after: sunset
      condition: sun
  action:
  - data: {}
    entity_id: light.yeelight_color1_04cf8caff0a4
    service: light.turn_on
  - data:
      entity_id: timer.drawing_room
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.drawing_room
    service: timer.start
- id: '1585417563605'
  alias: Turn On Kitchen Lamp when motion detected
  description: ''
  trigger:
  - device_id: 0310800ab747484283cf6fb58715fb0d
    domain: binary_sensor
    entity_id: binary_sensor.kitchen_motion
    platform: device
    type: motion
  condition:
  - condition: or
    conditions:
    - before: sunrise
      condition: sun
    - after: sunset
      condition: sun
  action:
  - data: {}
    entity_id: light.yeelight_color1_7c49eb12a895
    service: light.turn_on
  - data:
      entity_id: timer.kitchen
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.kitchen
    service: timer.start
- id: '1585418369243'
  alias: Turn Off Lounge Lamp when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.lounge
    event_type: timer.finished
    platform: event
  action:
  - data: {}
    entity_id: light.yeelight_color1_7c49eb139475
    service: light.turn_off
- id: '1585418369247'
  alias: Turn Off Basement Hall Lights when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.basement_hall
    event_type: timer.finished
    platform: event
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_3
    service: light.turn_off
- id: '1585418369244'
  alias: Turn Off Drawing Room Lamp when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.drawing_room
    event_type: timer.finished
    platform: event
  action:
  - data: {}
    entity_id: light.yeelight_color1_04cf8caff0a4
    service: light.turn_off
- id: '1585418369245'
  alias: Turn Off Kitchen Lamp when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.kitchen
    event_type: timer.finished
    platform: event
  action:
  - data: {}
    entity_id: light.yeelight_color1_7c49eb12a895
    service: light.turn_off
- id: '1585418369242'
  alias: Turn Off Snug Light when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.snug
    event_type: timer.finished
    platform: event
  action:
  - data: {}
    entity_id: light.sonoff_100032a00d_2
    service: light.turn_off
- id: '1585495667956'
  alias: Turn Off Dining Room Light when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.dining_room
    event_type: timer.finished
    platform: event
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032a00d_1
    service: light.turn_off
- id: '1585495887855'
  alias: Turn Off Utility Light when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.utility
    event_type: timer.finished
    platform: event
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_2
    service: light.turn_off
- id: '1585495887856'
  alias: Turn Off Toilet Light when there is no motion
  description: ''
  trigger:
  - event_data:
      entity_id: timer.toilet
    event_type: timer.finished
    platform: event
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_1
    service: light.turn_off
- id: '1585498703721'
  alias: Turn On Utility Light when motion detected
  description: ''
  trigger:
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.utility_motion
    for:
      hours: 0
      minutes: 0
      seconds: 0
    platform: device
    type: motion
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_2
    service: light.turn_on
  - data:
      entity_id: timer.utility
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.utility
    service: timer.start
- id: '1585498745227'
  alias: Turn On Dining Room Light when motion detected
  description: ''
  trigger:
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.dining_room_motion
    for:
      hours: 0
      minutes: 0
      seconds: 0
    platform: device
    type: motion
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032a00d_1
    service: light.turn_on
  - data:
      entity_id: timer.dining_room
    service: timer.cancel
  - data:
      duration: 00:05:00
      entity_id: timer.dining_room
    service: timer.start
- id: '1585498745228'
  alias: Turn On Toilet Light when motion detected
  description: ''
  trigger:
  - device_id: f918e214648f4e25848333fcea985dfe
    domain: binary_sensor
    entity_id: binary_sensor.toilet_motion
    platform: device
    type: motion
  condition: []
  action:
  - data: {}
    entity_id: light.sonoff_100032bd73_1
    service: light.turn_on
  - data:
      entity_id: timer.toilet
    service: timer.cancel
  - data:
      duration: 00:02:00
      entity_id: timer.toilet
    service: timer.start
- id: '1587464597280'
  alias: Sump Alarm Triggered
  description: The sump is at risk of overflowing, the pump may be offline or broken
  trigger:
  - device_id: 67c16ded941843d59f95ea1394628b0a
    domain: binary_sensor
    entity_id: binary_sensor.sump_alarm_trigger
    platform: device
    type: turned_on
  condition: []
  action:
  - data:
      title: Sump Alarm Triggered
      message: The sump alarm has been triggered, check the sump pump has power, this
        could cause a flood if not attended.
      data:
        file_url: https://media.istockphoto.com/vectors/vector-fire-alarm-vector-id610426096?k=6&m=610426096&s=612x612&w=0&h=IIjBibeAUNdoq7XS4-esMGyxxw_xFkb07zbwKcwNB-I=
      target:
      - email/mcinnes01@gmail.com
      - device/AndyPhone
    service: notify.pushbullet
  - data:
      title: Sump Alarm Triggered
      message: The sump alarm has been triggered, check the sump pump has power, this
        could cause a flood if not attended.
      target:
      - media_player.everywhere
      data:
        type: announce
    service: notify.alexa_media
