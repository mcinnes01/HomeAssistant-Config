- id: alarm_trigger
  alias: Trigger alarm while armed away
  trigger:
  - platform: device
    device_id: 212665b3f569c509043064bb2bf88374
    domain: device_tracker
    entity_id: dedcb54e9838456b76766de373504b87
    type: leaves
    zone: zone.home
  - platform: device
    device_id: 3cf9e880497a947bf86f81e62cdb9fc3
    domain: device_tracker
    entity_id: 856d22f7ea78d933842ce936fb263427
    type: leaves
    zone: zone.home
  condition:
  - condition: state
    entity_id: alarm_control_panel.alarm
    state: armed_away
  action:
  - data: {}
    entity_id: alarm_control_panel.alarm
    service: alarm_control_panel.alarm_trigger
- alias: Send notification when alarm triggered
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: triggered
  action:
  - data:
      title: Alarm Triggered
      message: ALARM! The alarm has been triggered
      data:
        file_url: https://media.istockphoto.com/vectors/vector-fire-alarm-vector-id610426096?k=6&m=610426096&s=612x612&w=0&h=IIjBibeAUNdoq7XS4-esMGyxxw_xFkb07zbwKcwNB-I=
      target:
      - email/mcinnes01@gmail.com
      - device/AndyPhone
    service: notify.pushbullet
  - service: notify.alexa_media
    data:
      title: Alarm Triggered
      message: The alarm has been triggered. The alarm has been triggered. The alarm
        has been triggered. The alarm has been triggered. The alarm has been triggered.
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  id: 33a13ad590164e5a9542f8223820a928
- alias: Turn On Ex Machina lights when alarm triggered
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: triggered
  action:
  - data: {}
    entity_id: light.inside
    service: light.turn_off
  - data:
      brightness_pct: 100
      effect: Alarm
    entity_id: light.yeelights
    service: light.turn_on
  id: 71bcd308a0bc484793b7d78e8ec8e69d
- alias: Send notification when alarm is Disarmed
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: disarmed
  action:
  - service: notify.alexa_media
    data:
      title: Alarm disarmed
      message: ALARM! The alarm is Disarmed at {{ states('sensor.date_time') }}
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  id: 63385e6035f643aab8b67f619af4951b
- alias: Turn Off Ex Machina lights when alarm disarmed
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: disarmed
  action:
  - data:
      effect: Stop
    entity_id: light.yeelights
    service: light.turn_on
  - data: {}
    entity_id: light.yeelights
    service: light.turn_off
  id: 71bcd308a0bc484793b7d78e8ec8e69f
- id: a71c90774150444f9237ba14769e935a
  alias: Send notification when alarm is arming
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    from: disarmed
    to: pending
  action:
  - service: notify.alexa_media
    data:
      title: Alarm arming
      message: The alarm is arming you have 60 seconds to leave
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  mode: single
- alias: Send notification when alarm is pending
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    from: armed
    to: pending
  action:
  - service: notify.alexa_media
    data:
      title: Alarm pending
      message: You have 30 seconds to disable the alarm
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  id: df6ae52914e648ec8d170fc4e508c29e
- alias: Send notification when alarm is Armed in Away mode
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_away
  action:
  - service: notify.alexa_media
    data:
      title: Alarm armed in away mode
      message: The alarm is armed in Away mode
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  id: e430701364844f3da246e6f2db218214
- alias: Send notification when alarm is Armed in Home mode
  trigger:
  - platform: state
    entity_id: alarm_control_panel.alarm
    to: armed_home
  action:
  - service: notify.alexa_media
    data:
      title: Alarm armed in home mode
      message: The alarm is armed in Home mode
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  id: b762a0f5608845a2800b4b408924d844
- id: '1621858546623'
  alias: Andy is home
  description: ''
  trigger:
  - platform: device
    device_id: 212665b3f569c509043064bb2bf88374
    domain: device_tracker
    entity_id: dedcb54e9838456b76766de373504b87
    type: enters
    zone: zone.home
  condition: []
  action:
  - wait_for_trigger:
    - platform: state
      entity_id:
      - binary_sensor.cellar_door
      - binary_sensor.patio_door
      - binary_sensor.front_door_contact
      to: 'on'
    continue_on_timeout: false
    timeout:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - service: notify.alexa_media
    data:
      data:
        type: announce
        state: all
      target: media_player.all_speakers
      message: Welcome home Andy
      title: Andy is home
  mode: single
- id: '1619549518704'
  alias: Shower timer start
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.bathroom_motion
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.in_shower
    state: 'true'
  action:
  - service: timer.start
    data:
      duration: '600'
  mode: restart
- id: '1619550242949'
  alias: Shower timer finished
  description: ''
  trigger:
  - platform: event
    event_type: timer.finished
    event_data:
      entity_id: timer.shower
  condition:
  - condition: state
    entity_id: input_boolean.in_shower
    state: 'true'
  action:
  - service: light.turn_off
    target:
      area_id: cc4d1282baa64200a75e9347f5f87bdb
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.in_shower
  mode: single
- id: '1624467229490'
  alias: In bed
  description: ''
  triggers:
  - entity_id: binary_sensor.in_bed
    to: 'on'
    for: 00:05:00
    trigger: state
  conditions:
  - condition: time
    after: '20:00:00'
    before: 07:30:00
  actions:
  - target:
      entity_id: input_boolean.in_bed
    action: input_boolean.turn_on
    data: {}
  mode: single
- id: '1624870805960'
  alias: Out of bed
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.in_bed
    to: 'off'
    for: 00:05:00
  condition:
  - condition: time
    after: 05:00:00
    before: '12:00:00'
  action:
  - service: input_boolean.turn_off
    target:
      entity_id: input_boolean.in_bed
  mode: single
- id: '1628234751548'
  alias: Feed Cats
  description: Morning and Evening Cat feeding with options to disable next feed or
    turn off morning and/or evening feed
  trigger:
  - platform: time
    at: input_datetime.morning_feed_time
    id: morning-feed
  - platform: time
    at: input_datetime.evening_feed_time
    id: evening-feed
  condition:
  - condition: or
    conditions:
    - condition: and
      conditions:
      - condition: trigger
        id: morning-feed
      - condition: state
        entity_id: switch.morning_feed_enabled
        state: 'on'
      - condition: state
        entity_id: switch.morning_feed_complete
        state: 'off'
    - condition: and
      conditions:
      - condition: trigger
        id: evening-feed
      - condition: state
        entity_id: switch.evening_feed_enabled
        state: 'on'
      - condition: state
        entity_id: switch.evening_feed_complete
        state: 'off'
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: morning-feed
      sequence:
      - service: switch.turn_off
        target:
          entity_id: switch.evening_feed_complete
        data: {}
      - choose:
        - conditions:
          - condition: state
            entity_id: switch.disable_next_feed
            state: 'on'
          sequence:
          - service: switch.turn_off
            target:
              entity_id: switch.disable_next_feed
            data: {}
          - service: switch.turn_on
            data: {}
            target:
              entity_id: switch.morning_feed_complete
        default:
        - service: switch.turn_on
          target:
            entity_id: switch.dispenser_motor
          data: {}
        - delay:
            hours: 0
            minutes: 1
            seconds: 20
            milliseconds: 0
        - service: switch.turn_on
          target:
            entity_id: switch.morning_feed_complete
          data: {}
    - conditions:
      - condition: trigger
        id: evening-feed
      sequence:
      - service: switch.turn_off
        target:
          entity_id: switch.morning_feed_complete
        data: {}
      - choose:
        - conditions:
          - condition: state
            entity_id: switch.disable_next_feed
            state: 'on'
          sequence:
          - service: switch.turn_off
            target:
              entity_id: switch.disable_next_feed
            data: {}
          - service: switch.turn_on
            data: {}
            target:
              entity_id: switch.evening_feed_complete
        default:
        - service: switch.turn_on
          target:
            entity_id: switch.dispenser_motor
          data: {}
        - delay:
            hours: 0
            minutes: 1
            seconds: 20
            milliseconds: 0
        - service: switch.turn_on
          target:
            entity_id: switch.evening_feed_complete
          data: {}
    default: []
  mode: single
- id: '1621858546622'
  alias: Claire is home
  description: ''
  trigger:
  - platform: device
    device_id: 3cf9e880497a947bf86f81e62cdb9fc3
    domain: device_tracker
    entity_id: device_tracker.claires_iphone
    type: enters
    zone: zone.home
  condition: []
  action:
  - wait_for_trigger:
    - platform: state
      entity_id:
      - binary_sensor.cellar_door
      - binary_sensor.patio_door
      - binary_sensor.front_door_contact
      to: 'on'
    continue_on_timeout: false
    timeout:
      hours: 0
      minutes: 10
      seconds: 0
      milliseconds: 0
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - service: notify.alexa_media
    data:
      data:
        type: announce
        state: all
      target: media_player.all_speakers
      message: Welcome home Claire
      title: Claire is home
  mode: single
- id: '1622742978922'
  alias: Loft hatch open
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 7edaef3b07fdf64472991cfe09e62c2b
    entity_id: binary_sensor.loft_hatch_contact
    domain: binary_sensor
  condition: []
  action:
  - service: notify.alexa_media
    data:
      message: Get off my things!
      target: media_player.all_speakers
      data:
        method: all
        type: announce
  mode: single
- id: '1622743049939'
  alias: Loft hatch closed
  description: ''
  trigger:
  - type: not_opened
    platform: device
    device_id: 7edaef3b07fdf64472991cfe09e62c2b
    entity_id: binary_sensor.loft_hatch_contact
    domain: binary_sensor
  condition: []
  action:
  - service: notify.alexa_media
    data:
      target: media_player.all_speakers
      message: You better put them back where you found them!
      data:
        method: all
        type: announce
  mode: single
- id: 34d291332d9d4a9185327573b8c1a90f
  alias: Lounge Scene Watch Television
  description: ''
  triggers:
  - entity_id: input_select.lounge_mode
    to: Television
    trigger: state
  conditions: []
  actions:
  - target:
      entity_id:
      - group.lounge_overrides
    data: {}
    action: input_boolean.turn_on
  - target:
      entity_id:
      - light.lounge_light
    data: {}
    action: light.turn_off
  - data:
      kelvin: 3700
      brightness: 80
    target:
      entity_id:
      - light.lounge_lamp
      - light.lounge_floor_lamp
    action: yeelight.set_color_temp_scene
  - action: media_player.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: media_player.lounge_tv
  mode: single
- id: '1621853753389'
  alias: Patio door is open
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.patio_door
    to: 'on'
  condition: []
  action:
  - service: notify.alexa_media
    data:
      data:
        type: announce
        state: all
      title: Door Open
      target: media_player.all_speakers
      message: Patio door is open!
  mode: single
- id: doorbell_trigger
  alias: Doorbell Notifications
  triggers:
  - entity_id: binary_sensor.doorbell_button
    to: 'on'
    trigger: state
  actions:
  - action: notify.mobile_app_pixel_6
    data:
      message: 'Doorbell '
  - data:
      message: Ding dong! Someone is at the door!
      title: Doorbell rang
      target: media_player.all_speakers
      data:
        type: announce
        state: all
    action: notify.alexa_media
    enabled: true
  - action: notify.mobile_app_claireiphone
    data:
      message: Doorbell
  - delay: 15
  mode: single
  max_exceeded: silent
- id: '1579518320766'
  alias: Turn On Porch Light when Sun is set
  trigger:
  - event: sunset
    platform: sun
  action:
  - entity_id: light.porch_light
    service: light.turn_on
- id: '1579518409890'
  alias: Turn Off Porch Light at 11pm
  trigger:
  - at: '22:30:00'
    platform: time
  action:
  - entity_id: light.porch_light
    service: light.turn_off
- alias: Snug Scene Normal
  id: '1624997862387'
  description: ''
  trigger:
  - platform: state
    entity_id: input_select.snug_mode
    to: Normal
  condition: []
  action:
  - service: script.room_controller_reset
    data:
      room: Snug
- alias: Snug Scene Watch Movie
  id: '1624997862389'
  description: ''
  trigger:
  - platform: state
    entity_id: input_select.snug_mode
    to: Movie
  condition: []
  action:
  - service: script.room_controller_reset
    data:
      room: Snug
  - service: input_boolean.turn_on
    target:
      entity_id:
      - group.snug_overrides
  - service: light.turn_off
    target:
      entity_id:
      - light.snug_light
      - light.basement_hall_light
  - service: light.turn_on
    target:
      entity_id: light.snug_lamp
    data:
      rgb_color: 70,70,255
      brightness: 184
  mode: single
- id: '1587464597280'
  alias: Sump Alarm Triggered
  description: The sump is at risk of overflowing, the pump may be offline or broken
  trigger:
  - device_id: 67c16ded941843d59f95ea1394628b0a
    domain: binary_sensor
    entity_id: binary_sensor.sump_alarm_trigger
    platform: device
    type: turned_on
  action:
  - service: notify.alexa_media
    data:
      title: Sump Alarm Triggered
      message: The sump alarm has been triggered, check the sump pump has power, this
        could cause a flood if not attended.
      target: media_player.all_speakers
      data:
        type: announce
        method: all
- id: '1631300005347'
  alias: Snug Lights Off Reset Mode
  description: ''
  trigger:
  - platform: state
    entity_id: light.snug_lights
    to: 'off'
  condition: []
  action:
  - service: input_select.select_option
    data:
      option: Normal
    target:
      entity_id: input_select.snug_mode
  mode: single
- id: '1631300046090'
  alias: Bedroom Lights Off Reset Mode
  description: ''
  trigger:
  - platform: state
    entity_id: light.bedroom_lights
    to: 'off'
  condition: []
  action:
  - service: input_select.select_option
    data:
      option: Normal
    target:
      entity_id: input_select.bedroom_mode
  mode: single
- id: '1638630199969'
  alias: Low battery level detection & notification for all battery sensors
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      actions:
      - device_id: 212665b3f569c509043064bb2bf88374
        domain: mobile_app
        type: notify
        message: 'Low battery found for the following sensors: {{sensors}}'
        title: Low battery warning
      - device_id: 3cf9e880497a947bf86f81e62cdb9fc3
        domain: mobile_app
        type: notify
        message: 'Low battery found for the following sensors: {{sensors}}'
        title: Low battery warning
- id: '1650023117276'
  alias: Set cat feeder varaibles on restart
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.morning_feed_enabled
    to: unknown
    from: unavailable
    for:
      hours: 0
      minutes: 0
      seconds: 10
  action:
  - service: input_boolean.toggle
    data: {}
    target:
      entity_id:
      - input_boolean.evening_feed_complete
      - input_boolean.evening_feed_enabled
      - input_boolean.morning_feed_complete
      - input_boolean.morning_feed_enabled
      - input_boolean.disable_next_feed
  - service: input_boolean.toggle
    data: {}
    target:
      entity_id:
      - input_boolean.morning_feed_complete
      - input_boolean.morning_feed_enabled
      - input_boolean.evening_feed_complete
      - input_boolean.evening_feed_enabled
      - input_boolean.disable_next_feed
  mode: single
- id: '1661598529211'
  alias: Door open
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: e87ea564142edf52ebc5fb9d015444ed
    entity_id: binary_sensor.front_door_contact
    domain: binary_sensor
  - type: opened
    platform: device
    device_id: aa915be8056811eba8e26dd5543ccd1c
    entity_id: binary_sensor.patio_door
    domain: binary_sensor
  condition: []
  action:
  - device_id: 4e9fa6ad723069dbba61e2d42fbac1cb
    domain: alarm_control_panel
    entity_id: eb9b4716a145ea15841f703e5ae2c0ab
    type: trigger
  mode: single
- id: '1671115791416'
  alias: Guest Room Remote Actions
  description: ''
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: Zigbee2MQTT
      controller_entity: sensor.guest_room_remote_action
      helper_last_controller_event: input_text.guest_room_remote_last_state
      action_button_up_short:
      - target:
          entity_id:
          - light.guest_room_lamp
        data: {}
        action: light.turn_on
      action_button_up_long:
      - metadata: {}
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
        action: media_player.volume_up
      action_button_down_short:
      - data: {}
        target:
          entity_id: light.guest_room_light
        action: light.turn_off
      - target:
          entity_id:
          - light.guest_room_lamp
        data: {}
        action: light.turn_off
      - data:
          media_content_type: custom
          media_content_id: Turn off your screen
        target:
          entity_id: media_player.guest_room_echo_show
        action: media_player.play_media
      action_button_up_double:
      - data: {}
        target:
          entity_id: light.guest_room_light
        action: light.turn_on
      action_button_down_double: []
      action_button_down_long:
      - metadata: {}
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
        action: media_player.volume_down
      button_down_long_max_loop_repeats: 500
      controller_device: df7b1ea31d9a31f4dcf2431ca2221da6
- id: '1674657037158'
  alias: NSPanel Configuration
  description: ''
  use_blueprint:
    path: Blackymas/nspanel_blueprint.yaml
    input:
      nspanel_name: nspanel
      language: ENG
      sync_value_ha: select_yes
      sync_slider_ha: select_yes
      weather_entity: weather.stockport
      indoortemp: sensor.downstairs_thermostat_temperature
      humidity: sensor.downstairs_thermostat_humidity
      climate: climate.downstairs
      left_button_entity: light.backdoor_light
      left_button_name: Back door
      right_button_entity: light.patio_light
      right_button_name: Patio
      button_page01_label: Control Modes
      button_page02_label: Scenes
      button_page03_label: Climate
      button_page04_label: Lights
      qrcode_state: true
      qrcode_label: Guest Wifi
      qrcode_value: WIFI:T:WPA;S:Home.Guest.Wifi;P:J3llyt0ts
      entitypages_enabled: true
      date_format: '%d/%m'
- id: '1685484233163'
  alias: 'Bedroom show screen off '
  description: ''
  triggers:
  - entity_id:
    - input_select.bedroom_mode
    to: Sleeping
    trigger: state
  conditions: []
  actions:
  - data:
      media_content_type: custom
      media_content_id: Turn your screen off
    target:
      device_id: 05fc0ef00cc911eb9bd319798131fa33
    action: media_player.play_media
  mode: single
- id: '1685484296390'
  alias: Bedroom show screen on
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_select.bedroom_mode
    from: Sleeping
  condition: []
  action:
  - service: media_player.play_media
    data:
      media_content_type: custom
      media_content_id: home
    target:
      device_id: 05fc0ef00cc911eb9bd319798131fa33
  mode: single
- id: '1688678984181'
  alias: Conversation agent agenda notification
  description: ''
  use_blueprint:
    path: homeassistant/notify_agent_agenda.yaml
    input:
      conversation_agent: homeassistant
      notify_time: 07:30:00
      calendar_entity: calendar.home_andisoft_gmail_com
      weather_entity: weather.met_office_heaton_chapel_daily
      zone_entity: zone.home
- id: '1690477886669'
  alias: Carbon Monoxide Detected
  description: ''
  trigger:
  - type: carbon_monoxide
    platform: device
    device_id: 0c2573947bd6deea46d939a3047ce2fd
    entity_id: dbc4367f2c6d3c9233ac6dfce510c209
    domain: sensor
    above: 0
  - type: unsafe
    platform: device
    device_id: 0c2573947bd6deea46d939a3047ce2fd
    entity_id: dbef73995127a0829d9790ee389b3d88
    domain: binary_sensor
  condition: []
  action:
  - service: notify.alexa_media
    data:
      message: Emergency! Carbon Monoxide detected in the bedroom.
      title: Emergency Carbon Dioxide
      target: media_player.all_speakers
      data:
        type: announce
        method: all
  mode: single
- id: '1690477986993'
  alias: Replace Carbon Monoxide Batteries
  description: ''
  trigger:
  - type: battery_level
    platform: device
    device_id: 0c2573947bd6deea46d939a3047ce2fd
    entity_id: 3b09f2b298025bc88679672f50b15c9b
    domain: sensor
    below: 20
  condition: []
  action:
  - service: notify.alexa_media
    data:
      data:
        type: announce
        method: all
      message: Replace Carbon Monoxide Batteries
      target: media_player.all_speakers
      title: Replace Carbon Monoxide Batteries
  mode: single
- id: '1692479000916'
  alias: Cat feeding time
  description: ''
  trigger:
  - type: turned_on
    platform: device
    device_id: 37c3fe5808a7d0fb26aa048e3e0fc1bb
    entity_id: 7be4c4bb0c126e7f697e92996d3057cd
    domain: binary_sensor
  condition: []
  action:
  - data:
      target: media_player.all_speakers
      message: Rupert, Gunther it's dinner time you little beauties.
      data:
        type: announce
        method: all
      title: Cat's dinner time
    action: notify.alexa_media
  mode: single
- id: '1695982971531'
  alias: Turn the store light off
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: eb9331a7381930ba4800232f8e225dcf
    entity_id: 17733fd509a298cacae84a0f2b759326
    domain: light
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: eb9331a7381930ba4800232f8e225dcf
    entity_id: 17733fd509a298cacae84a0f2b759326
    domain: light
  mode: single
- id: '1701115009986'
  alias: Shed Door Open
  description: ''
  triggers:
  - type: opened
    device_id: 6f8559d1aa9eaadba986f9582dd59e42
    entity_id: 3a08a1fe45e2ee31b4990437f809aa5c
    domain: binary_sensor
    trigger: device
  - type: motion
    device_id: 9ac191139987008f2d426970a6803c80
    entity_id: ea9035c38f987cc128a94121bed9de04
    domain: binary_sensor
    trigger: device
  conditions:
  - condition: state
    entity_id: input_select.brightness
    state:
    - Dim
    - Dark
  actions:
  - type: turn_on
    device_id: 0310dc65362a7761574235ef385900ed
    entity_id: 5ef6609d7bee0398fa0100f1d52c0f6e
    domain: light
  mode: single
- id: '1702144702162'
  alias: Morning When Sunrise
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: 0
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.time_of_day
    data:
      option: Morning
  mode: single
- id: '1702145032588'
  alias: Sunset TimeOfDay Evening
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: 0
  - platform: time
    at: '18:00:00'
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: input_select.time_of_day
      state: Evening
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.time_of_day
    data:
      option: Evening
  mode: single
- id: '1702145565515'
  alias: Set TimeOfDay To Night
  description: ''
  trigger:
  - platform: time
    at: 02:00:00
  - platform: state
    entity_id:
    - binary_sensor.in_bed
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition:
  - condition: or
    conditions:
    - condition: time
      after: '21:00:00'
    - condition: time
      before: 02:01:00
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.time_of_day
    data:
      option: Night
  mode: single
- id: '1702145807178'
  alias: Set TimeOfDay To Day
  description: ''
  trigger:
  - platform: time
    at: '10:30:00'
  - platform: state
    entity_id:
    - binary_sensor.andy_in_bed
    - binary_sensor.claire_in_bed
    to: 'off'
  condition:
  - condition: and
    conditions:
    - condition: not
      conditions:
      - condition: state
        entity_id: input_select.time_of_day
        state: Day
    - condition: time
      after: 06:00:00
      before: '12:00:00'
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.time_of_day
    data:
      option: Day
  mode: single
- id: '1702146102248'
  alias: Set TimeOfDay To Afternoon
  description: ''
  trigger:
  - platform: time
    at: '12:01:00'
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.time_of_day
    data:
      option: Afternoon
  mode: single
- id: '1705132035494'
  alias: Ensure bed Socket on when sleeping
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_select.bedroom_mode
    to: Sleeping
    enabled: false
  action:
  - metadata: {}
    data: {}
    target:
      entity_id: switch.bed_socket
    action: switch.turn_on
  mode: single
- id: '1708902994480'
  alias: Keep Basement Hall On
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: eb9331a7381930ba4800232f8e225dcf
    entity_id: ed5bb7c9923aba60c360d18a01d63498
    domain: switch
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - type: turn_on
    device_id: eb9331a7381930ba4800232f8e225dcf
    entity_id: ed5bb7c9923aba60c360d18a01d63498
    domain: switch
  mode: single
- id: '1709056643855'
  alias: Turn on extractor fan
  description: ''
  trigger:
  - type: pm25
    platform: device
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: b91255e7f0c832496c13e82d8816c48a
    domain: sensor
    above: 40
  - type: humidity
    platform: device
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: cca0856fa881c95a112155145f3c1856
    domain: sensor
    above: 80
  condition: []
  action:
  - type: turn_on
    device_id: 53fee161c82e36216a2588d4db48d14e
    entity_id: 298e9c49e7a82bf1806662b428b52632
    domain: fan
  mode: single
- id: '1709056785566'
  alias: 'Turn off extractor '
  description: ''
  triggers:
  - type: humidity
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: cca0856fa881c95a112155145f3c1856
    domain: sensor
    below: 80
    trigger: device
    for:
      hours: 0
      minutes: 5
      seconds: 0
  - type: pm25
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: b91255e7f0c832496c13e82d8816c48a
    domain: sensor
    below: 40
    trigger: device
    for:
      hours: 0
      minutes: 5
      seconds: 0
  conditions:
  - type: is_humidity
    condition: device
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: cca0856fa881c95a112155145f3c1856
    domain: sensor
    below: 80
  - type: is_pm25
    condition: device
    device_id: 7c997ccb1bc8fd71717b511229494490
    entity_id: b91255e7f0c832496c13e82d8816c48a
    domain: sensor
    below: 40
  actions:
  - type: turn_off
    device_id: 53fee161c82e36216a2588d4db48d14e
    entity_id: 298e9c49e7a82bf1806662b428b52632
    domain: fan
  mode: single
- id: '1709132585047'
  alias: Turn on Bathroom Fan
  description: ''
  trigger:
  - type: humidity
    platform: device
    device_id: 8edd0ff47793be99d073bb320cf6df1d
    entity_id: fb7ba3be02e5c168029e24bbbc432f78
    domain: sensor
    above: 75
  condition: []
  action:
  - service: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.showering
  mode: single
- id: '1709132689233'
  alias: Turn off bathroom fan
  description: ''
  trigger:
  - type: humidity
    platform: device
    device_id: 8edd0ff47793be99d073bb320cf6df1d
    entity_id: fb7ba3be02e5c168029e24bbbc432f78
    domain: sensor
    below: 75
  condition: []
  action:
  - service: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.bathroom_normal
  mode: single
- id: '1709381408849'
  alias: Lounge Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Lounge Switch
      on_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.lounge_light
      off_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.lounge_light
        data: {}
      on_double_press: true
      on_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.watch_tv
      off_double_press: true
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.lounge_normal
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.lounge_echo_plus
      off_hold_action:
      - service: media_player.volume_down
        metadata: {}
        data: {}
        target:
          entity_id: media_player.lounge_echo_plus
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709381681373'
  alias: Drawing Room Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Drawing Room Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.drawing_room_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.drawing_room_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.drawing_room_echo_dot
      off_hold_action:
      - service: media_player.volume_down
        metadata: {}
        data: {}
        target:
          entity_id: media_player.drawing_room_echo_dot
      on_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.bookshelf_light
          - light.display_cabinet_light
      off_double_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.bookshelf_light
          - light.display_cabinet_light
        data: {}
      off_double_press: true
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709382599995'
  alias: Snug Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Snug Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.snug_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.snug_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.snug_echo_show
      off_hold_action:
      - service: media_player.volume_down
        target:
          entity_id:
          - media_player.snug_echo_show
        data: {}
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.watch_movie
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.lights_up
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709382680972'
  alias: Dining Room Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Dining Room Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.dining_room_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.dining_room_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.dining_room_echo_input
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.dining_room_echo_input
      on_double_press: false
      off_double_press: false
      on_double_press_action: []
      off_double_press_action: []
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709382833657'
  alias: Utility Room Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Utility Room Switch
      on_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.utility_room_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.utility_room_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.dressing_room_echo_dot
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.dressing_room_echo_dot
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        target:
          entity_id:
          - light.cellar_door_light
        data: {}
      off_double_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.cellar_door_light
        data: {}
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709382900054'
  alias: Toilet Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Toilet Switch
      on_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.toilet_light
      off_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.toilet_light
        data: {}
      on_hold_action: []
      off_hold_action: []
      on_double_press: false
      off_double_press: false
      on_double_press_action: []
      off_double_press_action: []
      helper_hold_delay: 250
      helper_max_loops: 10
- id: '1709382933875'
  alias: Store Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Store Switch
      on_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.store_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.store_light
      on_hold_action: []
      off_hold_action: []
      on_double_press: false
      off_double_press: false
      on_double_press_action: []
      off_double_press_action: []
      helper_hold_delay: 250
      helper_max_loops: 10
- id: '1709383049799'
  alias: Bedroom Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Bedroom Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_light
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.bedroom_lamp
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.bedroom_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.get_up
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.get_ready_for_bed
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709383207462'
  alias: Guest Room Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Guest Room Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_room_light
      - service: light.turn_off
        target:
          entity_id:
          - light.guest_room_lamp
        data: {}
      off_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.guest_room_light
        data: {}
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_room_lamp
      - service: light.turn_off
        target:
          entity_id:
          - light.guest_room_light
        data: {}
      off_double_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.guest_room_lamp
        data: {}
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1709383316606'
  alias: Dressing Room Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Dressing Room Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.dressing_room_light
      off_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.dressing_room_light
        data: {}
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_spot
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.bedroom_echo_spot
      on_double_press: false
      off_double_press: false
      on_double_press_action: []
      off_double_press_action: []
      helper_hold_delay: 250
      helper_max_loops: 10
- id: '1709384428713'
  alias: Bathroom Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Bathroom Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bathroom_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.bathroom_light
      on_hold_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.showering
      off_hold_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.bathroom_normal
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.mirror_light
      off_double_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.mirror_light
        data: {}
      helper_hold_delay: 1000
      helper_max_loops: 1
- id: '1709384557675'
  alias: Studio Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Studio Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.studio_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.studio_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.studio_echo_dot
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.studio_echo_dot
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: switch.turn_on
        target:
          entity_id: switch.studio_lamp
        data: {}
      off_double_press_action:
      - service: switch.turn_off
        target:
          entity_id:
          - switch.studio_lamp
        data: {}
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1714152051507'
  alias: Hallway Lamp On At Sunset
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: '-1'
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: input_select.location_mode
      state: Home
    - condition: state
      entity_id: input_select.location_mode
      state: OneAway
    - condition: state
      entity_id: input_select.location_mode
      state: Guests
    - condition: state
      entity_id: input_select.location_mode
      state: HouseSitter
  action:
  - type: turn_on
    device_id: 3f19fc07f1a211ea95ad67c149799e5f
    entity_id: 69604199395a225aac9e6fe69de4d16b
    domain: light
  mode: single
- id: '1714831180233'
  alias: Bedside Remote Actions
  description: ''
  use_blueprint:
    path: EPMatt/ikea_e1743.yaml
    input:
      integration: Zigbee2MQTT
      controller_device: 58709344f9c7b9f27d636aa393492456
      controller_entity: sensor.0xf082c0fffe3d9a0f_action
      helper_last_controller_event: input_text.bedside_remote_last_state
      action_button_up_short:
      - service: light.turn_on
        data:
          rgb_color:
          - 255
          - 255
          - 255
        target:
          entity_id: light.bedroom_lamp
      action_button_up_long:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      action_button_up_release: []
      action_button_up_double:
      - service: light.turn_on
        data:
          transition: 5
          color_temp: 318
          brightness: 255
        target:
          entity_id: light.bedroom_light
      action_button_down_short:
      - service: light.turn_off
        data: {}
        target:
          area_id: 704af1f2a4304506b399f87bbb27af1f
      - service: media_player.play_media
        data:
          media_content_type: custom
          media_content_id: Turn off your screen
        target:
          entity_id: media_player.bedroom_echo_show
      action_button_down_long:
      - service: media_player.volume_down
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      action_button_down_double:
      - service: media_player.play_media
        data:
          media_content_type: custom
          media_content_id: stop alarm
        target:
          entity_id: media_player.bedroom_echo_show
      button_up_long_loop: true
      button_down_long_loop: true
      button_up_double_press: true
      button_down_double_press: true
      helper_debounce_delay: 100
- id: '1716398696678'
  alias: Keep Hallway Light On
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 53fee161c82e36216a2588d4db48d14e
    entity_id: 238b38c8ff5e0feae04bd525730beb6a
    domain: switch
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - type: turn_on
    device_id: 53fee161c82e36216a2588d4db48d14e
    entity_id: 238b38c8ff5e0feae04bd525730beb6a
    domain: switch
  mode: single
- id: '1716399388502'
  alias: Keep Cabinet Light On
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: 64d07acdf42b5cdc381518c91beffdc9
    entity_id: 96092ec45fbc60be3b1c297a9fde0e75
    domain: light
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - type: turn_on
    device_id: 64d07acdf42b5cdc381518c91beffdc9
    entity_id: 96092ec45fbc60be3b1c297a9fde0e75
    domain: light
  mode: single
- id: '1717959862918'
  alias: Left Bedside Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Left Bedside Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_lamp
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.bedroom_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id:
          - light.bedroom_lamp
          - light.bedroom_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_light
      - service: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_lamp
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.lighting_night
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1717960070703'
  alias: Right Bedside Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Right Bedside Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_lamp
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.bedroom_light
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id:
          - light.bedroom_lamp
          - light.bedroom_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.bedroom_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_light
      - service: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.bedroom_lamp
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.lighting_night
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1717961103174'
  alias: Studio Bedside Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Studio Bedside Switch
      on_press_action:
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.studio_light
      - service: switch.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: switch.studio_lamp
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.studio_light
      - service: switch.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: switch.studio_lamp
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.studio_echo_dot
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.studio_echo_dot
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.studio_light
      - service: switch.turn_off
        target:
          entity_id:
          - switch.studio_lamp
        data: {}
      off_double_press_action:
      - service: switch.toggle
        metadata: {}
        data: {}
        target:
          entity_id: switch.hifi_socket
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1717961638399'
  alias: Snug Desk Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Snug Desk Switch
      on_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.snug_light
      - service: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.snug_lamp
          - light.snug_led_strip
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id:
          - light.snug_light
          - light.snug_lamp
          - light.snug_led_strip
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.snug_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.snug_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.snug_lamp
          - light.snug_led_strip
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.snug_light
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.watch_movie
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1717962211259'
  alias: Guest Room Bedside Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Guest Room Bedside Switch
      on_press_action:
      - service: light.turn_off
        data:
          transition: 3
        target:
          entity_id: light.guest_room_light
      - service: light.turn_on
        target:
          entity_id: light.guest_room_lamp
        data: {}
      off_press_action:
      - service: light.turn_off
        data: {}
        target:
          entity_id:
          - light.guest_room_lamp
          - light.guest_room_light
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
      off_hold_action:
      - service: media_player.volume_down
        data: {}
        target:
          entity_id: media_player.guest_room_echo_show
      on_double_press: true
      off_double_press: true
      on_double_press_action:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_room_light
      - service: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_room_lamp
      off_double_press_action: []
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1717962305271'
  alias: Lounge Sofa Switch
  description: ''
  use_blueprint:
    path: damru/ikea-rodret_E2201_ZHA-Z2M_control-anything.yaml
    input:
      remote_name: Lounge Sofa Switch
      on_press_action:
      - service: light.turn_on
        data: {}
        target:
          entity_id: light.lounge_light
      off_press_action:
      - service: light.turn_off
        target:
          entity_id:
          - light.lounge_light
        data: {}
      on_double_press: true
      on_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.watch_tv
      off_double_press: true
      off_double_press_action:
      - service: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.lounge_normal
      on_hold_action:
      - service: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.lounge_echo_plus
      off_hold_action:
      - service: media_player.volume_down
        metadata: {}
        data: {}
        target:
          entity_id: media_player.lounge_echo_plus
      helper_hold_delay: 750
      helper_max_loops: 10
- id: '1719939650314'
  alias: Reload Alexa Media Player after HA starts
  description: ''
  trigger:
  - platform: homeassistant
    event: start
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 1
      seconds: 0
      milliseconds: 0
  - alias: Reload Alexa Media Player integration
    service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: media_player.bedroom
    enabled: true
  mode: single
- id: '1722257720883'
  alias: New Automation
  description: ''
  trigger:
  - type: turned_on
    platform: device
    device_id: 74cbe41b5b5130da8a821ef1c1d36d1d
    entity_id: 8474a94bfca4c7108833d3f2d2ec4bbc
    domain: binary_sensor
  condition: []
  action:
  - service: notify.alexa_media
    data:
      data:
        type: announce
        state: all
      target: media_player.all_speakers
      message: Welcome home Claire
      title: Claire is home
  mode: single
- id: '1727562224816'
  alias: Patio Camera Snapshot, AI & Notification on Motion
  description: ''
  use_blueprint:
    path: mcinnes01/ai_camera_motion_notification.yaml
    input:
      camera_device: camera.patio_camera_medium_resolution_channel
      notify_device: 212665b3f569c509043064bb2bf88374
      motion_sensor: binary_sensor.patio_camera_motion
      ai_prompt: Motion has been detected, compare and very briefly describe what
        you see in the following sequence of images from my {{ camera_name }} camera
        or the last detection. What do you think caused the motion alarm? If a person,
        animal or car is present, describe them in detail, pay special attention to
        cats and what they are doing. If you see no obvious causes of motion, reply
        with "NOCHANGE". Your message needs to be short enough to fit in a phone notification.
      num_snapshots: 3
      condition_auto:
      - condition: or
        conditions:
        - condition: state
          entity_id: input_select.location_mode
          state: Away
        - condition: state
          entity_id: input_select.light_control_mode
          state: Sleeping
- id: '1727562283950'
  alias: Hallway Camera Snapshot, AI & Notification on Motion
  description: ''
  use_blueprint:
    path: mcinnes01/ai_camera_motion_notification.yaml
    input:
      camera_device: camera.hallway_camera_medium_resolution_channel
      notify_device: 212665b3f569c509043064bb2bf88374
      motion_sensor: binary_sensor.hallway_camera_motion
      num_snapshots: 3
      ai_prompt: Motion has been detected, compare and very briefly describe what
        you see in the following sequence of images from my {{ camera_name }} camera.
        What do you think caused the motion alarm? Tell me how many people come towards
        the camera through the door in the format "##IN:1##" and how many people walk
        away from the camera and out through the door in the format "##OUT:0##". Do
        not describe stationary objects or buildings. If you see no obvious causes
        of motion, reply with "Camera has detected motion however no obvious motion
        observed comparing snapshots". Your message needs to be short enough to fit
        in a phone notification.
      condition_auto:
      - condition: or
        conditions:
        - condition: state
          entity_id: input_select.location_mode
          state: OneAway
        - condition: state
          entity_id: input_select.location_mode
          state: Away
- id: '1727562661192'
  alias: Shed Camera Snapshot, AI & Notification on Motion
  description: ''
  triggers:
  - entity_id: binary_sensor.shed_camera_motion
    to: 'on'
    trigger: state
  actions:
  - if:
    - condition:
      - condition: state
        entity_id: input_select.location_mode
        state: Away
    then:
    - repeat:
        count: '{{ num_snapshots }}'
        sequence:
        - data:
            filename: ./www/snapshots/{{ camera_path }}_snapshot{{ repeat.index }}.jpg
          target:
            entity_id: '{{ camera_device }}'
          action: camera.snapshot
        - delay:
            milliseconds: 500
    - data:
        prompt: '{{ ai_prompt }}'
        image_filename: "{% set snap_count = 3 %} {% set ns = namespace(images=[])
          %} {% for i in range(1, snap_count + 1) %}\n  {% set image = \"./www/snapshots/\"
          ~ camera_path ~ \"_snapshot\" ~ i ~ \".jpg\" %}\n  {% set ns.images = ns.images
          + [image] %}\n{% endfor %} {{ ns.images }}\n"
      response_variable: generated_content
      action: google_generative_ai_conversation.generate_content
    - choose:
      - conditions:
        - condition: template
          value_template: "{{ generated_content['text'] != 'NOCHANGE' }} \n"
        sequence:
        - device_id: 212665b3f569c509043064bb2bf88374
          domain: mobile_app
          type: notify
          title: '{{ motion_name }} Detected'
          message: '{{ generated_content[''text''] }}'
          data: '{% set android_data = {"image": snapshot_access_file_path} %} {%
            set ios_data = {"attachment": {"url": snapshot_access_file_path, "content_type":
            "JPEG"}} %} {{ ios_data if is_ios else android_data }}

            '
  variables:
    camera_device: camera.shed_camera_medium_resolution_channel
    camera_name: '{{ state_attr(camera_device, ''friendly_name'') }}'
    camera_path: '{{ state_attr(camera_device, ''friendly_name'') | lower | replace(''
      '', ''_'') }}'
    motion_sensor: binary_sensor.shed_camera_motion
    motion_name: '{{ state_attr(motion_sensor, ''friendly_name'') }}'
    is_ios: false
    num_snapshots: 3
    snapshot_access_file_path: /local/snapshots/{{ camera_path }}_snapshot1.jpg
    ai_prompt: Motion has been detected, compare and very briefly describe what you
      see in the following sequence of images from my {{ camera_name }} camera or
      the last detection. What do you think caused the motion alarm? If a person,
      animal or car is present, describe them in detail, pay special attention to
      cats and what they are doing. If a car with the registration "LG18 PSU" arrives
      i.e. was not there previously and now is, Or leaves i.e. was there previously
      and now is not, reply "Car has arrived" or Car has left. Also comment on whether
      the black gates are open or closed when the cars location changes. If you see
      no obvious causes of motion, reply with "NOCHANGE". Your message needs to be
      short enough to fit in a phone notification.
    condition_auto:
    - condition: state
      entity_id: input_select.location_mode
      state: Away
  mode: single
- id: '1727732371723'
  alias: Basement Hall Camera Snapshot, AI & Notification on Motion
  description: ''
  use_blueprint:
    path: mcinnes01/ai_camera_motion_notification.yaml
    input:
      camera_device: camera.basement_hall_camera_medium_resolution_channel
      notify_device: 212665b3f569c509043064bb2bf88374
      motion_sensor: binary_sensor.basement_hall_camera_motion
      ai_prompt: Motion has been detected, compare and very briefly describe what
        you see in the following sequence of images from my {{ camera_name }} camera.
        What do you think caused the motion alarm? If a person, animal or car is present,
        describe them in detail, pay special attention to cats and what they are doing.
        Do not describe stationary objects or buildings. If you see no obvious causes
        of motion, reply with "Camera has detected motion however no obvious motion
        observed comparing snapshots". Your message needs to be short enough to fit
        in a phone notification.
      condition_auto:
      - condition: state
        entity_id: input_select.location_mode
        state: Away
      is_ios: false
- id: '1727732531669'
  alias: Kitchen Camera Snapshot, AI & Notification on Motion
  description: ''
  use_blueprint:
    path: mcinnes01/ai_camera_motion_notification.yaml
    input:
      camera_device: camera.kitchen_camera_medium_resolution_channel
      notify_device: 212665b3f569c509043064bb2bf88374
      motion_sensor: binary_sensor.kitchen_camera_motion
      ai_prompt: When motion has been detected,  briefly describe what changes you
        see in the snapshots from my {{ camera_name }} camera. If you see a person
        tell me your opinion of what they are wearing, what they look like and what
        they are doing in a very sassy manner. If you see a cat tell me what it's
        doing. If there are no people or cat's just respond with "NOCHANGE"
      condition_auto:
      - condition: state
        entity_id: input_select.location_mode
        state: Away
        enabled: true
        for:
          hours: 0
          minutes: 5
          seconds: 0
- id: '1730307028394'
  alias: Kitchen Wallboard Off
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.kitchen_motion
    - binary_sensor.kitchen_camera_motion
    - binary_sensor.kitchen_camera_person_detected
    - binary_sensor.kitchen_occupancy
    to: 'off'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_board_screen
  mode: single
- id: '1730307076644'
  alias: Kitchen Wallboard On
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.kitchen_motion
    - binary_sensor.kitchen_camera_motion
    - binary_sensor.kitchen_camera_person_detected
    - binary_sensor.kitchen_occupancy
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 0
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.kitchen_board_screen
  mode: single
- id: '1737788443298'
  alias: Cat in tray
  description: ''
  triggers:
  - type: occupied
    device_id: 152464013553416134ac864861e8ae82
    entity_id: d7af482f09ee05ac1d289576f1338044
    domain: binary_sensor
    trigger: device
  conditions: []
  actions:
  - action: notify.alexa_media_all_speakers
    metadata: {}
    data:
      message: Cat in tray
      data:
        type: announce
        state: all
      target: media_player.all_speakers
  - action: persistent_notification.create
    metadata: {}
    data:
      message: Cat in tray
      notification_id: catintray
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
  mode: single
- id: '1739019274052'
  alias: Shed No Motion
  description: ''
  triggers:
  - type: no_motion
    device_id: 9ac191139987008f2d426970a6803c80
    entity_id: ea9035c38f987cc128a94121bed9de04
    domain: binary_sensor
    trigger: device
    for:
      hours: 0
      minutes: 4
      seconds: 0
  conditions: []
  actions:
  - type: turn_off
    device_id: 0310dc65362a7761574235ef385900ed
    entity_id: 5ef6609d7bee0398fa0100f1d52c0f6e
    domain: light
  mode: single
- id: '1740127989989'
  alias: Ensure Bed Is Calibrated Weekly
  description: ''
  triggers:
  - trigger: time
    at: 09:15:00
  conditions:
  - condition: time
    weekday:
    - fri
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.bed_socket
  - delay:
      hours: 0
      minutes: 0
      seconds: 15
      milliseconds: 0
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.bed_socket
  - wait_for_trigger:
    - trigger: state
      entity_id:
      - light.bedroom_lamp
      from: unavailable
      to: 'on'
    timeout:
      hours: 0
      minutes: 3
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.bedroom_lamp
  mode: single
- id: '1740133279094'
  alias: Kitchen Switch
  description: ''
  use_blueprint:
    path: Tiisetso/Z2M_2.0.0_IKEA_STRYBAR_4_Button_Remote.yaml
    input:
      remote_device: 644de21c70910c6cce73c1094b2f419e
      action_on:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.kitchen_light
      action_off:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.breakfast_bar_lamp
      action_arrow_left_click:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.fence_lights
      action_arrow_left_release: []
      action_arrow_left_hold:
      - action: media_player.volume_down
        metadata: {}
        data: {}
        target:
          entity_id: media_player.kitchen_echo_show_2
      action_arrow_right_hold:
      - action: media_player.volume_up
        metadata: {}
        data: {}
        target:
          entity_id: media_player.kitchen_echo_show_2
      action_arrow_right_click:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          label_id: garden_access_lights
